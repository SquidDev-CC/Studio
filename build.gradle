apply plugin: 'java'
apply plugin: 'maven'

sourceCompatibility = 1.8

group = 'org.squiddev'
version = '0.1'

repositories {
	mavenCentral()

	maven {
		name = "squiddev"
		url = "http://maven.bonzodandd.co.uk"
	}

	ivy {
		name "ComputerCraft"
		artifactPattern "http://addons-origin.cursecdn.com/files/2228/723/[module][revision].[ext]"
	}
}

dependencies {
	// Core Libraries
	compile group: 'ComputerCraft', name: 'ComputerCraft', version: '1.73', ext: 'jar'
	compile group: 'org.squiddev', name: 'luaj.api', version: '1.+'
	compile group: 'org.squiddev', name: 'luaj.luajc', version: '1.+'

	// TerminalOutput dependencies
	compile group: 'jline', name: 'jline', version: '2.+'

	// LWJGL dependencies
	// http://build.lwjgl.org/stable/lwjgl.zip
	compile files('lib/jar/lwjgl.jar')

	testCompile group: 'junit', name: 'junit', version: '4.+'
}
configurations.all { exclude group: 'org.luaj' }

// Download LWJGL from online
task getLwjgl(type: Copy) {
	def f = file('lib/jar/lwjgl.jar')
	if (!f.exists()) {
		file("lib").mkdirs();
		def output = file("lib/lwjgl.zip")

		new URL('http://build.lwjgl.org/stable/lwjgl.zip').withInputStream {
			i -> output.withOutputStream { it << i }
		}
		from zipTree(output)
		into "lib"
	}
}

compileJava.dependsOn getLwjgl
